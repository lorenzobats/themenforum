{#include base}
{#title}{username}{/title}
{#body}
<div class="header">
    <div>
        <h1 class="mt-4">My Profile</h1>
        <p><a href="/ui/topics">[Browse Topics]</a><a href="/ui/posts">[Browse Posts]</a></p>
    </div>
    <div class="login-buttons">
        Logged in as: {username}
        <button class="btn btn-secondary" onclick="logout()">Logout</button>
    </div>
</div>
    <h2 class="mt-2">My Topics</h2>
    {#if topics}
    {#for entry in topics}
        <div class="content-box">
        <div>
        <h5 style="cursor: pointer" onclick="window.open('/ui/posts?topic={entry.topic.title}', '_self')" class="title-info">{entry.topic.title}</h5>
        <span>{entry.topic.parsedCreatedAtDate}</span>
        </div>
        </div>
        {/}
    {#else}
    <p>Du hast noch keine Topics veröffentlicht</p>
    {/if}
    <h2>My Posts</h2>
    {#if posts}
    {#for entry in posts}
        <div class="content-box">
        <div>
        <h5 style="cursor: pointer" onclick="window.open('/ui/posts/{entry.id}', '_self')" class="title-info">{entry.title}</h5>
        <span>{entry.parsedCreatedAtDate}</span>
        </div>
        </div>
        {/}
    {#else}
        <p>Du hast noch keine Posts veröffentlicht</p>
    {/if}
    <h2>My Comments</h2>
    {#if comments}
    {#for entry in comments}
        <div class="content-box">
        <div>
        <h5 style="cursor: pointer" onclick="window.open('/ui/posts/comment/{entry.id}#{entry.id}', '_self')" class="title-info">{entry.text}</h5>
        <span>{entry.parsedCreatedAtDate}</span>
        </div>
        </div>
        {/}
    {#else}
        <p>Du hast noch keine Kommentare geschrieben</p>
    {/if}
    <h2>Votes</h2>
    {#if votes}
    {#for entry in votes}
        <div class="content-box">
        <div>
        {#if entry.votedEntityString == 'POST'}
            <h5 style="cursor: pointer" onclick="window.open('/ui/posts/{entry.votedEntityId}', '_self')" class="title-info">Post</h5>
            <span>{entry.parsedCreatedAtDate}</span>
        {#else if entry.votedEntityString == 'COMMENT'}
            <h5 style="cursor: pointer" onclick="window.open('/ui/posts/comment/{entry.votedEntityId}#{entry.votedEntityId}', '_self')" class="title-info">Comment</h5>
            <span>{entry.parsedCreatedAtDate}</span>
        {/if}
        </div>
        </div>
        {/}
    {#else}
    <p>Du hast noch keine Inhalte bewertet</p>
    {/if}
{/body}
{/include}
<script>

    window.onload = function () {
        let searchParam = new URL(window.location.href).searchParams.get("active");
        if (searchParam) {
            // TODO: Tab Funktionalität einbauen
            document.getElementById("search").value = searchParam;
        }
    };

    function getPostByCommentId(commentId) {
        fetch('/')
    }

    function createTopic() {
        window.open('/ui/topics/new', '_self');
    }

    function logout() {
        document.cookie = "quarkus-credential=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        document.cookie = "quarkus-redirect-location=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        location.reload();
    }
</script>